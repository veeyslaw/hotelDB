treat exceptions
ROLLBACK in error?

recheck all constraints
refactor?